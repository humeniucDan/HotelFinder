{"ast":null,"code":"import { vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, withModifiers as _withModifiers, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, Fragment as _Fragment, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"form-inline position-absolute top-0 start-50 translate-middle-x\",\n  style: {\n    \"z-index\": \"1\"\n  }\n};\nconst _hoisted_2 = {\n  class: \"input-group m-2\"\n};\nconst _hoisted_3 = {\n  class: \"d-flex justify-content-between flex-direction: column\"\n};\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"div\", {\n  id: \"map-div\",\n  style: {\n    \"width\": \"85%\",\n    \"height\": \"100vh\"\n  }\n}, null, -1 /* HOISTED */);\nconst _hoisted_5 = {\n  class: \"bg-secondary text-white bg-opacity-25\",\n  style: {\n    \"z-index\": \"3\",\n    \"width\": \"15%\"\n  }\n};\nconst _hoisted_6 = {\n  class: \"m-3\"\n};\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"h4\", null, [/*#__PURE__*/_createElementVNode(\"strong\", null, \"Cancel a reservation\")], -1 /* HOISTED */);\nconst _hoisted_8 = [_hoisted_7];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_hotels_list = _resolveComponent(\"hotels-list\");\n  const _component_reservation_form = _resolveComponent(\"reservation-form\");\n  const _component_cancel_form = _resolveComponent(\"cancel-form\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"form\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_withDirectives(_createElementVNode(\"input\", {\n    class: \"form-control border border-danger rounded-4 rounded-end\",\n    type: \"number\",\n    placeholder: \"Range\",\n    \"aria-label\": \"Search\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.range = $event)\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.range]]), _createElementVNode(\"button\", {\n    class: \"btn btn-danger rounded-4 rounded-start\",\n    type: \"submit\",\n    onClick: _cache[1] || (_cache[1] = _withModifiers((...args) => $options.loadHotelMarkers && $options.loadHotelMarkers(...args), [\"prevent\"]))\n  }, \"Search\")])]), _createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_hotels_list, {\n    hotelsData: $data.hotels,\n    openForm: $options.openForm\n  }, null, 8 /* PROPS */, [\"hotelsData\", \"openForm\"]), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"btn btn-danger\",\n    onClick: _cache[2] || (_cache[2] = _withModifiers(() => {}, [\"prevent\"]))\n  }, [..._hoisted_8])])])]), $data.reservationFormActive == true ? (_openBlock(), _createBlock(_component_reservation_form, {\n    key: 0,\n    closeForm: $options.closeForm,\n    passedHotelId: $data.curHotelId,\n    rooms: $data.curHotelRooms,\n    submitForm: $options.requestReservation\n  }, null, 8 /* PROPS */, [\"closeForm\", \"passedHotelId\", \"rooms\", \"submitForm\"])) : _createCommentVNode(\"v-if\", true), $data.cancelFormActive == true ? (_openBlock(), _createBlock(_component_cancel_form, {\n    key: 1,\n    closeForm: $options.closeCancelForm\n  }, null, 8 /* PROPS */, [\"closeForm\"])) : _createCommentVNode(\"v-if\", true)], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["class","style","_createElementVNode","id","_hoisted_7","_createElementBlock","_Fragment","_hoisted_1","_hoisted_2","type","placeholder","_cache","$event","$data","range","onClick","_withModifiers","args","$options","loadHotelMarkers","_hoisted_3","_hoisted_4","_hoisted_5","_createVNode","_component_hotels_list","hotelsData","hotels","openForm","_hoisted_6","_hoisted_8","reservationFormActive","_createBlock","_component_reservation_form","key","closeForm","passedHotelId","curHotelId","rooms","curHotelRooms","submitForm","requestReservation","_createCommentVNode","cancelFormActive","_component_cancel_form","closeCancelForm"],"sources":["C:\\SIEMENS_Proj\\front-end\\src\\App.vue"],"sourcesContent":["<template>\n  <form class=\"form-inline position-absolute top-0 start-50 translate-middle-x\" style=\"z-index: 1\">\n    <div class=\"input-group m-2\">\n      <input class=\"form-control border border-danger rounded-4 rounded-end\" type=\"number\" placeholder=\"Range\" aria-label=\"Search\"\n        v-model=\"range\"\n      >\n      <button class=\"btn btn-danger rounded-4 rounded-start\" type=\"submit\"\n        @click.prevent=\"loadHotelMarkers\"\n      >Search</button>\n    </div>\n  </form>\n  \n\n  <div class=\"d-flex justify-content-between flex-direction: column\">\n    <div id=\"map-div\" style=\"width:85%; height: 100vh\"></div>\n    <div class=\"bg-secondary text-white bg-opacity-25\" style=\"z-index:3; width:15%\">\n      <hotels-list\n        :hotelsData=\"hotels\"\n        :openForm=\"openForm\"\n      >\n      \n      </hotels-list>\n      <div class=\"m-3\">\n        <button type=\"button\" class=\"btn btn-danger\"\n          @click.prevent=\"\"\n        >\n          <h4><strong>Cancel a reservation</strong></h4></button>\n      </div>\n    </div>\n  </div>\n \n  <reservation-form\n    :closeForm=\"closeForm\" \n    v-if=\"reservationFormActive == true\"\n    :passedHotelId=\"curHotelId\"\n    :rooms=\"curHotelRooms\"\n    :submitForm=\"requestReservation\"\n  >\n  </reservation-form>\n\n  <cancel-form\n    :closeForm=\"closeCancelForm\" \n    v-if=\"cancelFormActive == true\"\n  >\n  </cancel-form>\n\n</template>\n\n<style>\n  input::-webkit-outer-spin-button,\n  input::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n  }\n</style>\n\n<script>\nimport { Loader } from '@googlemaps/js-api-loader';\nimport HotelsList from './components/ValidHotelsList.vue';\nimport ReservationForm from './components/ReservationForm.vue';\nimport CancelForm from './components/CancelForm.vue';\n// import split from 'core-js/fn/symbol/split';\n\n\nexport default {\n  components:{\n    HotelsList,\n    ReservationForm,\n    CancelForm\n  },\n\n  data(){\n    return {\n      lat: 0,\n      lng: 0,\n      range: null,\n      position: new Object(),\n      map: [],\n      hotels: [],\n      curPosMarker: [],\n      hotelMarkers: [],\n      reservationFormActive: false,\n      curHotelId: 0,\n      curHotelRooms: [],\n      cancelFormActive: false\n    };\n  },\n\n  created() {\n    this.getLocation()\n    this.loadMap()\n    // this.loadHotelMarkers()\n  },\n\n\n  methods: {\n    getLocation() {\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition((position) => {\n          this.lat = position.coords.latitude   \n          this.lng = position.coords.longitude\n          this.position.lat = position.coords.latitude\n          this.position.lng = position.coords.longitude\n          // console.log(\"getloc \" + this.lat)\n        })\n      } else {\n        console.log(\"Geolocation is not supported by this browser.\")\n      }\n    },\n\n    async loadMap() {\n      const loader = new Loader({ apiKey: 'AIzaSyA1M_-TOE9rtwD_SkcfAkcjEpHJhk6RY6g' });\n\n      try {\n          await loader.importLibrary(\"maps\");\n\n          const position = { lat: this.lat, lng: this.lng};\n\n          this.map = new google.maps.Map(document.getElementById(\"map-div\"), {\n              zoom: 15,\n              center: {lat: this.lat, lng: this.lng},\n              // mapId: \"NoPOI\"\n              styles:  [\n                      {\n                        featureType: \"poi\",\n                        stylers: [{ visibility: \"off\" }],\n                      }\n                    ]\n          });\n\n          this.curPosMarker = new google.maps.Marker({\n            map: this.map,\n            position: {lat: this.lat, lng: this.lng},\n            icon: {\n              url:'https://maps.google.com/mapfiles/ms/icons/blue-dot.png',\n              labelOrigin: {\n                x: 15,\n                y: 40\n              }\n            },\n            label: { color: '#000000', fontWeight: 'bold', fontSize: '14px', text: 'You are here' }\n          });\n\n\n      } catch (error) {\n          console.error(\"Error loading map:\", error);\n          \n      }\n    },\n\n    async openForm(hotelId){\n      let roomsData = await fetch(\"http://localhost:8000/hotels/retRooms-\" + hotelId)\n      let tempRooms = await roomsData.json()\n      this.curHotelRooms = tempRooms\n      console.log(hotelId, tempRooms)\n      this.reservationFormActive = true\n      this.curHotelId = hotelId\n      console.log(this.curHotelId)\n    },\n\n    closeForm(){\n      this.reservationFormActive = false;\n      console.log(this.reservationFormActive)\n    },\n\n    async requestReservation(reservation){\n      if(!reservation.name || reservation.roomNumber == undefined || !reservation.checkIn || !reservation.checkOut) {\n        alert(\"Please fill the whole form!\")\n        return\n      }\n\n      console.log(reservation, reservation.roomNumber)\n      var splitData = reservation.roomNumber.split(' ')\n      reservation.roomNumber = splitData[1].slice(0, -1)\n\n      console.log(reservation);\n      let response = await fetch(\"http://localhost:8000/reservations\", {\n          method: \"POST\",\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(reservation)\n      })\n      var respData = await response.json()\n\n      if(!respData) {\n        alert(\"Selected room is not available at that time.\")\n        return\n      }\n\n      console.log(respData)\n    },\n\n    async loadHotelMarkers(){\n\n      for(var mi in this.hotelMarkers){\n        console.log(this.hotelMarkers[mi])  \n        this.hotelMarkers[mi].setMap(null)\n        this.hotelMarkers[mi].setVisible(false)\n      }\n\n      this.hotelMarkers = []\n      \n      let hotelsJSON = await fetch(\"http://localhost:8000/hotels/retall\", {\n          method: \"POST\",\n          headers: { 'Content-Type': 'application/json' },\n          body: \"{\\\"range\\\":\\\"\" + this.range + \"\\\", \\\"lat\\\":\\\"\" + this.lat + \"\\\", \\\"lng\\\":\\\"\" + this.lng + \"\\\"}\"\n      })\n      this.hotels = await hotelsJSON.json()\n\n      for(var i in this.hotels){\n        let hotel  = this.hotels[i]\n        var curHotelMarker = new google.maps.Marker({\n              map: this.map,\n              position: {lat: hotel.lat, lng: hotel.lng},\n              title: hotel.name,\n              icon: {\n                url: 'https://maps.google.com/mapfiles/ms/icons/red-dot.png',\n                labelOrigin: {\n                  x: 15,\n                  y: 40\n                }\n              },\n              label: { color: '#000000', fontWeight: 'bold', fontSize: '14px', text: hotel.name }\n        })\n        this.hotelMarkers.push(curHotelMarker);\n\n        google.maps.event.addListener(curHotelMarker, 'click', () => { \n            var localHotelId = hotel.id\n            console.log(hotel.id)\n            this.openForm(localHotelId);\n        });\n\n        console.log(this.hotelMarkers[this.hotelMarkers.length-1])\n      }\n    },\n    closeCancelForm(){\n      this.cancelFormActive = false;\n    }\n  }\n}\n</script>\n"],"mappings":";;EACQA,KAAK,EAAC,iEAAiE;EAACC,KAAkB,EAAlB;IAAA;EAAA;;;EACvED,KAAK,EAAC;AAAiB;;EAWzBA,KAAK,EAAC;AAAuD;gCAChEE,mBAAA,CAAyD;EAApDC,EAAE,EAAC,SAAS;EAACF,KAAgC,EAAhC;IAAA;IAAA;EAAA;;;EACbD,KAAK,EAAC,uCAAuC;EAACC,KAA4B,EAA5B;IAAA;IAAA;EAAA;;;EAO5CD,KAAK,EAAC;AAAK;gCAIZE,mBAAA,CAA8C,a,aAA1CA,mBAAA,CAAqC,gBAA7B,sBAAoB,E;oBAAhCE,UAA8C,C;;;;;uBA1BxDC,mBAAA,CAAAC,SAAA,SACEJ,mBAAA,CASO,QATPK,UASO,GARLL,mBAAA,CAOM,OAPNM,UAOM,G,gBANJN,mBAAA,CAEC;IAFMF,KAAK,EAAC,yDAAyD;IAACS,IAAI,EAAC,QAAQ;IAACC,WAAW,EAAC,OAAO;IAAC,YAAU,EAAC,QAAQ;IAHlI,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAIiBC,KAAA,CAAAC,KAAK,GAAAF,MAAA;iDAALC,KAAA,CAAAC,KAAK,E,GAEhBZ,mBAAA,CAEgB;IAFRF,KAAK,EAAC,wCAAwC;IAACS,IAAI,EAAC,QAAQ;IACjEM,OAAK,EAAAJ,MAAA,QAAAA,MAAA,MAPdK,cAAA,KAAAC,IAAA,KAOwBC,QAAA,CAAAC,gBAAA,IAAAD,QAAA,CAAAC,gBAAA,IAAAF,IAAA,CAAgB;KACjC,QAAM,E,KAKXf,mBAAA,CAgBM,OAhBNkB,UAgBM,GAfJC,UAAyD,EACzDnB,mBAAA,CAaM,OAbNoB,UAaM,GAZJC,YAAA,CAKcC,sBAAA;IAJXC,UAAU,EAAEZ,KAAA,CAAAa,MAAM;IAClBC,QAAQ,EAAET,QAAA,CAAAS;uDAIbzB,mBAAA,CAKM,OALN0B,UAKM,GAJJ1B,mBAAA,CAGyD;IAHjDO,IAAI,EAAC,QAAQ;IAACT,KAAK,EAAC,gBAAgB;IACzCe,OAAK,EAAAJ,MAAA,QAAAA,MAAA,MAxBhBK,cAAA,CAwBU,QAAiB;KAxB3B,IAAAa,UAAA,G,OAiCUhB,KAAA,CAAAiB,qBAAqB,Y,cAF7BC,YAAA,CAOmBC,2BAAA;IAtCrBC,GAAA;IAgCKC,SAAS,EAAEhB,QAAA,CAAAgB,SAAS;IAEpBC,aAAa,EAAEtB,KAAA,CAAAuB,UAAU;IACzBC,KAAK,EAAExB,KAAA,CAAAyB,aAAa;IACpBC,UAAU,EAAErB,QAAA,CAAAsB;oFApCjBC,mBAAA,gBA0CU5B,KAAA,CAAA6B,gBAAgB,Y,cAFxBX,YAAA,CAIcY,sBAAA;IA5ChBV,GAAA;IAyCKC,SAAS,EAAEhB,QAAA,CAAA0B;4CAzChBH,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}